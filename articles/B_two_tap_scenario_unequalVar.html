<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="rabBITS">
<title>The two-tap scenario with unequal variances â€¢ rabBITS</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="The two-tap scenario with unequal variances">
<meta property="og:description" content="rabBITS">
<meta property="og:image" content="https://xaverfuchs.github.io/rabBITS/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rabBITS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/A_two_tap_scenario_equalVariance.html">The two-tap scenario with equal variances</a>
    <a class="dropdown-item" href="../articles/B_two_tap_scenario_unequalVar.html">The two-tap scenario with unequal variances</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>The two-tap scenario with unequal variances</h1>
            
      
      
      <div class="d-none name"><code>B_two_tap_scenario_unequalVar.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://xaverfuchs.github.io/rabBITS/">rabBITS</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span> <span class="co">#for adding ggplots</span></span></code></pre></div>
<div class="section level2">
<h2 id="two-tap-case-with-unequal-variances">Two-tap case with unequal variances<a class="anchor" aria-label="anchor" href="#two-tap-case-with-unequal-variances"></a>
</h2>
<p>In the previous article [REF], we covered the special case where the
(inverse) spatial precision, <em>sigma_s</em> is the same for both
spatial positions. This is often not realistic, as the spatial
resolution of the skin varies between sections of the skin, even along
one limb. This can be addressed by a generalized form of the model, that
takes single precision parameters for tap 1 and 2.</p>
<div class="section level3">
<h3 id="prior-likelihood-posterior-figure-with-unequal-spatial-variance">Prior-Likelihood-Posterior figure with unequal spatial variance<a class="anchor" aria-label="anchor" href="#prior-likelihood-posterior-figure-with-unequal-spatial-variance"></a>
</h3>
<p>We will create a different version of the figure, where
<em>sigma_s1</em>, the inverse precision of tap 1, is 1 and
<em>sigma_s2</em>, the inverse precisino of tap 2, takes the value of
2.</p>
<div class="section level4">
<h4 id="model-parameters">Model parameters<a class="anchor" aria-label="anchor" href="#model-parameters"></a>
</h4>
<p>The following parameters are used in the article and are used here
for plotting.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Parameters of the stimuli and observer</span></span>
<span><span class="va">x1m</span><span class="op">=</span><span class="fl">3</span> <span class="co">#measured position of tap 1 (in cm)</span></span>
<span><span class="va">x2m</span><span class="op">=</span><span class="fl">7</span> <span class="co">#measured position of tap 2 (in cm)</span></span>
<span><span class="va">time_t</span> <span class="op">=</span> <span class="fl">0.15</span> <span class="co">#time between stimuli, i.e., interstimulus time (in seconds)</span></span>
<span><span class="va">sigma_s1</span> <span class="op">=</span> <span class="fl">1</span> <span class="co">#spatial (im)precision (in cm as a sd)</span></span>
<span><span class="va">sigma_s2</span> <span class="op">=</span> <span class="fl">3</span> <span class="co">#spatial (im)precision (in cm as a sd)</span></span>
<span><span class="va">sigma_v</span> <span class="op">=</span> <span class="fl">10</span> <span class="co">#low speed prior (in cm/s as an sd)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="parameters-for-the-plots">Parameters for the plots<a class="anchor" aria-label="anchor" href="#parameters-for-the-plots"></a>
</h4>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#params for plots</span></span>
<span><span class="va">x1_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">x2_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#resolution for graphs</span></span>
<span><span class="va">x1_res</span> <span class="op">&lt;-</span> <span class="fl">100</span> </span>
<span><span class="va">x2_res</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span></span>
<span><span class="co">#matrix for the x1-x2 combinations</span></span>
<span><span class="va">x1x2Mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>x1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">x1_range</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x1_range</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, length.out <span class="op">=</span> <span class="va">x1_res</span><span class="op">)</span>, x2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">x2_range</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x2_range</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, length.out <span class="op">=</span> <span class="va">x2_res</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="compute-the-values-for-the-whole-matrix">Compute the values for the whole matrix<a class="anchor" aria-label="anchor" href="#compute-the-values-for-the-whole-matrix"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### XXX Compute prior density</span></span>
<span><span class="va">x1x2Mat</span><span class="op">$</span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prior_2Tap.html">prior_2Tap</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="va">x1x2Mat</span><span class="op">$</span><span class="va">x1</span>, x2 <span class="op">=</span> <span class="va">x1x2Mat</span><span class="op">$</span><span class="va">x2</span>, time_t <span class="op">=</span> <span class="va">time_t</span>, sigma_v <span class="op">=</span> <span class="va">sigma_v</span><span class="op">)</span></span>
<span></span>
<span><span class="co">### XXX Compute likelihood</span></span>
<span><span class="va">x1x2Mat</span><span class="op">$</span><span class="va">likelihood</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/likelihood_2Tap_UneqVar.html">likelihood_2Tap_UneqVar</a></span><span class="op">(</span>x1m<span class="op">=</span><span class="va">x1m</span>, x2m<span class="op">=</span><span class="va">x2m</span>, x1<span class="op">=</span><span class="va">x1x2Mat</span><span class="op">$</span><span class="va">x1</span>, x2<span class="op">=</span><span class="va">x1x2Mat</span><span class="op">$</span><span class="va">x2</span>, sigma_s1 <span class="op">=</span> <span class="va">sigma_s1</span>, sigma_s2 <span class="op">=</span> <span class="va">sigma_s2</span><span class="op">)</span></span>
<span></span>
<span><span class="co">### XXX Compute posterior density</span></span>
<span><span class="va">x1x2Mat</span><span class="op">$</span><span class="va">posterior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/posterior_2Tap_UneqVar.html">posterior_2Tap_UneqVar</a></span><span class="op">(</span>x1m<span class="op">=</span><span class="va">x1m</span>, x2m<span class="op">=</span><span class="va">x2m</span>, x1 <span class="op">=</span> <span class="va">x1x2Mat</span><span class="op">$</span><span class="va">x1</span>, x2 <span class="op">=</span> <span class="va">x1x2Mat</span><span class="op">$</span><span class="va">x2</span>, time_t <span class="op">=</span> <span class="va">time_t</span>, sigma_s1 <span class="op">=</span> <span class="va">sigma_s1</span>, sigma_s2 <span class="op">=</span> <span class="va">sigma_s2</span>, sigma_v <span class="op">=</span> <span class="va">sigma_v</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="create-plots">Create Plots<a class="anchor" aria-label="anchor" href="#create-plots"></a>
</h4>
<p>Now create a plot of all three distributions (like in Figure 2).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#prior</span></span>
<span><span class="va">prior.plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">x1x2Mat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x1</span>, y<span class="op">=</span><span class="va">x2</span>, fill<span class="op">=</span><span class="va">prior</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"prior"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#likelihood</span></span>
<span><span class="va">likelihood.plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">x1x2Mat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x1</span>, y<span class="op">=</span><span class="va">x2</span>, fill<span class="op">=</span><span class="va">likelihood</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"likelihood"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#posterior</span></span>
<span><span class="va">posterior.plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">x1x2Mat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x1</span>, y<span class="op">=</span><span class="va">x2</span>, fill<span class="op">=</span><span class="va">posterior</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"posterior"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="compute-posterior-modes-and-add-to-the-plots">Compute posterior modes and add to the plots<a class="anchor" aria-label="anchor" href="#compute-posterior-modes-and-add-to-the-plots"></a>
</h4>
<p>We can also add the real positions to the plots and compute the
posterior means and add them as well so it becomes better visible how
the posterior is dragged towards the prior. The posterior modes are
computed with the function <em>posterior_params_2Tap_EqVar()</em></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#likelihood</span></span>
<span><span class="va">likelihood.plot</span> <span class="op">&lt;-</span> <span class="va">likelihood.plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x1m</span>, y<span class="op">=</span><span class="va">x2m</span>, size<span class="op">=</span><span class="fl">2</span>, color<span class="op">=</span><span class="st">"white"</span>, shape<span class="op">=</span><span class="fl">21</span>, fill<span class="op">=</span><span class="cn">NA</span><span class="op">)</span> <span class="co">#measured position</span></span>
<span></span>
<span><span class="co">#posterior modes</span></span>
<span><span class="va">Posterior_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/posterior_params_2Tap_UneqVar.html">posterior_params_2Tap_UneqVar</a></span><span class="op">(</span>x1m <span class="op">=</span> <span class="va">x1m</span>, x2m <span class="op">=</span> <span class="va">x2m</span>, time_t <span class="op">=</span> <span class="va">time_t</span>,</span>
<span>                                     sigma_s1 <span class="op">=</span> <span class="va">sigma_s1</span>, sigma_s2 <span class="op">=</span> <span class="va">sigma_s2</span>, sigma_v <span class="op">=</span> <span class="va">sigma_v</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Posterior_mode_x1</span> <span class="op">&lt;-</span> <span class="va">Posterior_params</span><span class="op">$</span><span class="va">x1_star</span></span>
<span><span class="va">Posterior_mode_x2</span> <span class="op">&lt;-</span> <span class="va">Posterior_params</span><span class="op">$</span><span class="va">x2_star</span></span>
<span></span>
<span><span class="co">#update posterior plot</span></span>
<span><span class="va">posterior.plot</span> <span class="op">&lt;-</span> <span class="va">posterior.plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x1m</span>, y<span class="op">=</span><span class="va">x2m</span>, size<span class="op">=</span><span class="fl">2</span>, color<span class="op">=</span><span class="st">"white"</span>, shape<span class="op">=</span><span class="fl">21</span>, fill<span class="op">=</span><span class="cn">NA</span><span class="op">)</span> <span class="op">+</span> <span class="co">#measured position</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Posterior_mode_x1</span> , y<span class="op">=</span><span class="va">Posterior_mode_x2</span>, size<span class="op">=</span><span class="fl">2</span>, color<span class="op">=</span><span class="st">"red"</span>, shape<span class="op">=</span><span class="fl">21</span>, fill<span class="op">=</span><span class="cn">NA</span><span class="op">)</span> <span class="co">#posterior mode</span></span>
<span></span>
<span></span>
<span><span class="co">#join plots</span></span>
<span><span class="va">p.joined</span> <span class="op">&lt;-</span> <span class="va">prior.plot</span> <span class="op">+</span> <span class="va">likelihood.plot</span> <span class="op">+</span> <span class="va">posterior.plot</span></span>
<span><span class="va">p.joined</span></span></code></pre></div>
<div class="figure">
<img src="B_two_tap_scenario_unequalVar_files/figure-html/fig-all-distributions-1.png" alt="prior, likelihood, and posterior distributions" width="700"><p class="caption">
prior, likelihood, and posterior distributions
</p>
</div>
</div>
<div class="section level4">
<h4 id="numerical-sanity-check">Numerical sanity check<a class="anchor" aria-label="anchor" href="#numerical-sanity-check"></a>
</h4>
<p>As a quick sanity check: compare the analytically determined
posterior modes to the ones that can be seen in the figure. This can
simply be done by finding the value with the highest posterior
probability numerically and checking where it is.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Posterior modes determined analytically</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"analytical values for x1:"</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">Posterior_mode_x1</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>            <span class="st">"\n and for x2:"</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">Posterior_mode_x2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "analytical values for x1: 3.327 \n and for x2: 4.061"</span></span>
<span></span>
<span><span class="co">#Posterior mode determined numerically</span></span>
<span><span class="va">posteriorMax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x1x2Mat</span><span class="op">$</span><span class="va">posterior</span><span class="op">)</span></span>
<span><span class="va">posteriorMax.index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">x1x2Mat</span><span class="op">$</span><span class="va">posterior</span><span class="op">==</span><span class="va">posteriorMax</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"numerical values for x1:"</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">x1x2Mat</span><span class="op">$</span><span class="va">x1</span><span class="op">[</span><span class="va">posteriorMax.index</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>            <span class="st">"\n and for x2:"</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">x1x2Mat</span><span class="op">$</span><span class="va">x2</span><span class="op">[</span><span class="va">posteriorMax.index</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "numerical values for x1: 3.333 \n and for x2: 4.04"</span></span></code></pre></div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Xaver Fuchs.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
