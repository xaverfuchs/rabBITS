<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="rabBITS">
<title>The two-tap scenario with equal variances • rabBITS</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="The two-tap scenario with equal variances">
<meta property="og:description" content="rabBITS">
<meta property="og:image" content="https://xaverfuchs.github.io/rabBITS/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rabBITS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/A_two_tap_scenario_equalVariance.html">The two-tap scenario with equal variances</a>
    <a class="dropdown-item" href="../articles/B_two_tap_scenario_unequalVar.html">The two-tap scenario with unequal variances</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>The two-tap scenario with equal variances</h1>
            
      
      
      <div class="d-none name"><code>A_two_tap_scenario_equalVariance.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://xaverfuchs.github.io/rabBITS/">rabBITS</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span> <span class="co">#for adding ggplots</span></span></code></pre></div>
<div class="section level2">
<h2 id="two-tap-case-with-equal-variances">Two-tap case with equal variances<a class="anchor" aria-label="anchor" href="#two-tap-case-with-equal-variances"></a>
</h2>
<p>In this simple scenario, we consider two stimuli (“taps”) that are
presented on the skin in two positions and are separated in time. The
“simple” Bayesian Observer Model makes predictions how the
spatiotemporal characteristics of the stimuli, the spatial precisino of
the touch sense, and a prior about movement speed influence the
perceived positions of the stimuli. In this model, we assume the spatial
precision of both touched positions to be idetical, hence it is called
the <em>equal variance</em> case.</p>
<p>The used terminology and formulae are based on the article by
Goldreich &amp; Tong, 2013, PLOS ONE.</p>
<div class="section level3">
<h3 id="background-information">Background information<a class="anchor" aria-label="anchor" href="#background-information"></a>
</h3>
<p>Some basic assumptions of the Bayesian Observer Model are:</p>
<ol style="list-style-type: decimal">
<li>stimuli (on the skin) are never perceived with perfect precision,
because the skin’s spatial resolution is imperfect and therefore each
stimulus sensed with a certain (random) measurement error</li>
<li>successive stimuli are caused by an object moving along the
skin</li>
<li>objects move at a realistic speed. Or, in other words, it is
unlikely that objects move very fast and that stimuli therefore move a
far distance in a short time</li>
</ol>
<p>The second assumption is referred to as the low-speed (or:
low-velocity) prior.</p>
<div class="section level4">
<h4 id="hypotheses-derived-from-the-model">Hypotheses derived from the model<a class="anchor" aria-label="anchor" href="#hypotheses-derived-from-the-model"></a>
</h4>
<p>Some hypotheses that can be derived from the described model are:</p>
<ol style="list-style-type: decimal">
<li>stimuli that are presented far apart and fast will be perceptually
attracted towards each other, i.e. there is a perceptual <em>length
contraction</em>
</li>
<li>the faster the stimulation, the stronger is the length
contraction</li>
<li>the further the spatial distance between the stimuli, the stronger
the length contraction</li>
<li>the higher the precision, the weaker the length contraction</li>
<li>the stronger the low-speed prior, the stronger the length
contraction</li>
</ol>
</div>
</div>
<div class="section level3">
<h3 id="parameters">Parameters<a class="anchor" aria-label="anchor" href="#parameters"></a>
</h3>
<p>The model includes the following parameters:</p>
<ul>
<li>
<span class="math inline">\(x_{1m}\)</span> and <span class="math inline">\(x_{2m}\)</span> as the “measured” or “sensed”
positions, i.e. the estimate given by the sensors corresponding to the
stimulus positions</li>
<li>
<span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> as the inferred or hypothetical
stimulus positions</li>
<li>
<span class="math inline">\(t\)</span> as the time (in seconds)
passing between the taps</li>
<li>
<span class="math inline">\(\sigma_s\)</span> the spatial standard
deviation, or uncertainty, referring to the sensed positions (<span class="math inline">\(x_{1m}\)</span> and <span class="math inline">\(x_{2m}\)</span>). Higher values indicate lower
precision.</li>
<li>
<span class="math inline">\(\sigma_v\)</span> the degree of the
“low-speed” prior. Lower values indicate slower expected speed, or, a
“stronger” prior.</li>
</ul>
<p>A word about units: Although the units of time and space are
arbitrary as long as they are consistent, there is a consistent use of
units in the literature. Usually, all spatial units <span class="math inline">\(x_{1m}\)</span>, <span class="math inline">\(x_{2m}\)</span>, <span class="math inline">\(x_1\)</span>, <span class="math inline">\(x_1\)</span>, and <span class="math inline">\(\sigma_s\)</span> are expressed in cm units. And
time, <span class="math inline">\(t\)</span> is expressed as seconds.
The low-speed prior <span class="math inline">\(\sigma_v\)</span> is
expressed as space per time units and when using cm and seconds would be
cm/s. The <span class="math inline">\(\sigma_s\)</span> is sometimes
conceptually referred to as the average localization error, e.g. with
reference to the paper by Weinstein (1968) with 1 cm. Strictly speaking,
however, it refers to the standard deviation, or variable error, of
spatial localization.</p>
</div>
<div class="section level3">
<h3 id="formula-for-prior-distribution">Formula for prior distribution<a class="anchor" aria-label="anchor" href="#formula-for-prior-distribution"></a>
</h3>
<p>In the appendix of the article, the formula for the prior
distribution is given in Formula A08 as:</p>
<p><span class="math display">\[p(x_1,x_2|t) \propto p(x_2|x_1,t) =
\frac {1} {\sqrt{2\pi}\sigma_vt} exp(-\frac {(x_2-x_1)^2}{2(\sigma_v
t)^2})\]</span></p>
</div>
<div class="section level3">
<h3 id="formula-for-the-likelihood-distribution">Formula for the likelihood distribution<a class="anchor" aria-label="anchor" href="#formula-for-the-likelihood-distribution"></a>
</h3>
<p>The formula for the likelihood distribution is given in Formula A10
as: <span class="math display">\[p(x_{1m},x_{2m}|x_1, x_2, t) =
p(x_2|x_1,t) = p(x_{1m}|x_1)*p(x_{2m}|x_2)\]</span> And these two
conditional probabilities are defined in A11 as: <span class="math display">\[p(x_{1m}|x_1) = \frac {1} {\sqrt{2\pi}\sigma_s}
exp \left(-\frac {(x_{1m}-x_1)^2}{2\sigma_s^2} \right)\]</span> and
<span class="math display">\[p(x_{2m}|x_2) = \frac {1}
{\sqrt{2\pi}\sigma_s} exp \left(-\frac
{(x_{2m}-x_2)^2}{2\sigma_s^2}\right)\]</span></p>
<p>Following logically from this, the likelihood computes as: <span class="math display">\[p(x_{1m},x_{2m}|x_1, x_2, t) = \frac {1}
{\sqrt{2\pi}\sigma_s} exp \left(-\frac
{(x_{2m}-x_2)^2}{2\sigma_s^2}\right) * \frac {1} {\sqrt{2\pi}\sigma_s}
exp \left(-\frac {(x_{2m}-x_2)^2}{2\sigma_s^2} \right)\]</span></p>
</div>
<div class="section level3">
<h3 id="formula-for-the-posterior-distribution">Formula for the posterior distribution<a class="anchor" aria-label="anchor" href="#formula-for-the-posterior-distribution"></a>
</h3>
<p>The formula for the posterior distribution is given in A13 as: <span class="math display">\[p(x_1, x_2|x_{1m},x_{2m}, t) \propto exp \left( -
\left( \frac {(x_{1m} - x_1)^2 + (x_{2m} - x_2)^2} {2\sigma_s ^2} +
\frac {(x_2-x_1)^2}{(2\sigma_v t)^2} \right) \right)\]</span></p>
<p>The formula for the posterior distribution is also formulated in in
A14 as:</p>
<p><span class="math display">\[p(x_1, x_2|x_{1m},x_{2m}, t) \propto exp
\left( -\frac {1} {2(1-\rho ^2)} \left( \frac {(x_1 - x_{1*})^2 + (x_2 -
x_{2*})^2 - 2 \rho (x_1 - x_{1*}) (x_2 - x_{2*})} {\sigma ^2} \right)
\right)\]</span> However, some unknowns appear in this equation which
are defined further down in A14. The posterior modes, denoted as <span class="math inline">\(x_{1*}\)</span> and <span class="math inline">\(x_{2*}\)</span> are defined as:</p>
<p><span class="math display">\[x_{1*}=x_{1m} \left( \frac {(\sigma_v
t)^2 + \sigma_s ^2} {(\sigma_v t)^2 + 2\sigma_s ^2} \right) + x_{2m}
\left( \frac {\sigma_s^2} {(\sigma_v t)^2 + 2\sigma_s ^2}
\right)\]</span> and: <span class="math display">\[x_{2*}=x_{2m} \left(
\frac {(\sigma_v t)^2 + \sigma_s ^2} {(\sigma_v t)^2 + 2\sigma_s ^2}
\right) + x_{1m} \left( \frac {\sigma_s^2} {(\sigma_v t)^2 + 2\sigma_s
^2} \right)\]</span></p>
<p>The correlation between the Gaussian distributions <span class="math inline">\(\rho\)</span> is given as:</p>
<p><span class="math display">\[\rho = \frac {\sigma_s^2} {\sigma_s^2 +
(\sigma_v t)^2} \]</span> Finally, the combined variance <span class="math inline">\(\sigma^2\)</span> is given as:</p>
<p><span class="math display">\[\sigma^2 =  \sigma_s^2 \frac {\sigma_s^2
+ (\sigma_v t)^2} {2\sigma_s^2 + (\sigma_v t)^2}\]</span></p>
</div>
<div class="section level3">
<h3 id="r-implementations-of-the-formulae">R implementations of the formulae<a class="anchor" aria-label="anchor" href="#r-implementations-of-the-formulae"></a>
</h3>
<p>Some of the formulae presented above, are implemented in
<em>rabBITS</em>:</p>
<ul>
<li>Formula A08 is implemented as <em>prior_2Tap()</em>
</li>
<li>Formula A11 is implemented as <em>likelihood_2Tap_EqVar()</em>
</li>
<li>Formula A13 is implemented as <em>posterior_2Tap_EqVar()</em>
</li>
<li>(Parts of) Formula A14 are implemented as
<em>posterior_params_2Tap_EqVar()</em>
</li>
</ul>
<p><strong>Note:</strong> the R functions presented below can also
compute several values at a time, if the parameters are passed as
vectors. You will see applications of that in the examples below.</p>
</div>
<div class="section level3">
<h3 id="reproduce-figure-2">Reproduce Figure 2<a class="anchor" aria-label="anchor" href="#reproduce-figure-2"></a>
</h3>
<p>In the following, we reproduce Figure 2 from Goldreich &amp; Tong,
2013.</p>
<div class="section level4">
<h4 id="model-parameters">Model parameters<a class="anchor" aria-label="anchor" href="#model-parameters"></a>
</h4>
<p>The following parameters are used in the article and are used here
for plotting.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Parameters of the stimuli and observer</span></span>
<span><span class="va">x1m</span><span class="op">=</span><span class="fl">3</span> <span class="co">#measured position of tap 1 (in cm)</span></span>
<span><span class="va">x2m</span><span class="op">=</span><span class="fl">7</span> <span class="co">#measured position of tap 2 (in cm)</span></span>
<span><span class="va">time_t</span> <span class="op">=</span> <span class="fl">0.15</span> <span class="co">#time between stimuli, i.e., interstimulus time (in seconds)</span></span>
<span><span class="va">sigma_s</span> <span class="op">=</span> <span class="fl">1</span> <span class="co">#spatial (im)precision (in cm as a sd)</span></span>
<span><span class="va">sigma_v</span> <span class="op">=</span> <span class="fl">10</span> <span class="co">#low speed prior (in cm/s as an sd)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="parameters-for-the-plots">Parameters for the plots<a class="anchor" aria-label="anchor" href="#parameters-for-the-plots"></a>
</h4>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#params for plots</span></span>
<span><span class="va">x1_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">x2_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#resolution for graphs</span></span>
<span><span class="va">x1_res</span> <span class="op">&lt;-</span> <span class="fl">100</span> </span>
<span><span class="va">x2_res</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span></span>
<span><span class="co">#matrix for the x1-x2 combinations</span></span>
<span><span class="va">x1x2Mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>x1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">x1_range</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x1_range</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, length.out <span class="op">=</span> <span class="va">x1_res</span><span class="op">)</span>, x2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">x2_range</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x2_range</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, length.out <span class="op">=</span> <span class="va">x2_res</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="compute-the-values-for-the-whole-matrix">Compute the values for the whole matrix<a class="anchor" aria-label="anchor" href="#compute-the-values-for-the-whole-matrix"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### XXX Compute prior density</span></span>
<span><span class="va">x1x2Mat</span><span class="op">$</span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prior_2Tap.html">prior_2Tap</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="va">x1x2Mat</span><span class="op">$</span><span class="va">x1</span>, x2 <span class="op">=</span> <span class="va">x1x2Mat</span><span class="op">$</span><span class="va">x2</span>, time_t <span class="op">=</span> <span class="va">time_t</span>, sigma_v <span class="op">=</span> <span class="va">sigma_v</span><span class="op">)</span></span>
<span></span>
<span><span class="co">### XXX Compute likelihood</span></span>
<span><span class="va">x1x2Mat</span><span class="op">$</span><span class="va">likelihood</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/likelihood_2Tap_EqVar.html">likelihood_2Tap_EqVar</a></span><span class="op">(</span>x1m<span class="op">=</span><span class="va">x1m</span>, x2m<span class="op">=</span><span class="va">x2m</span>, x1<span class="op">=</span><span class="va">x1x2Mat</span><span class="op">$</span><span class="va">x1</span>, x2<span class="op">=</span><span class="va">x1x2Mat</span><span class="op">$</span><span class="va">x2</span>, sigma_s <span class="op">=</span> <span class="va">sigma_s</span><span class="op">)</span></span>
<span></span>
<span><span class="co">### XXX Compute posterior density</span></span>
<span><span class="va">x1x2Mat</span><span class="op">$</span><span class="va">posterior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/posterior_2Tap_EqVar.html">posterior_2Tap_EqVar</a></span><span class="op">(</span>x1m<span class="op">=</span><span class="va">x1m</span>, x2m<span class="op">=</span><span class="va">x2m</span>, x1 <span class="op">=</span> <span class="va">x1x2Mat</span><span class="op">$</span><span class="va">x1</span>, x2 <span class="op">=</span> <span class="va">x1x2Mat</span><span class="op">$</span><span class="va">x2</span>, time_t <span class="op">=</span> <span class="va">time_t</span>, sigma_s <span class="op">=</span> <span class="va">sigma_s</span>, sigma_v <span class="op">=</span> <span class="va">sigma_v</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="create-plots">Create Plots<a class="anchor" aria-label="anchor" href="#create-plots"></a>
</h4>
<p>Now create a plot of all three distributions (like in Figure 2).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#prior</span></span>
<span><span class="va">prior.plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">x1x2Mat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x1</span>, y<span class="op">=</span><span class="va">x2</span>, fill<span class="op">=</span><span class="va">prior</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"prior"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#likelihood</span></span>
<span><span class="va">likelihood.plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">x1x2Mat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x1</span>, y<span class="op">=</span><span class="va">x2</span>, fill<span class="op">=</span><span class="va">likelihood</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"likelihood"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#posterior</span></span>
<span><span class="va">posterior.plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">x1x2Mat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x1</span>, y<span class="op">=</span><span class="va">x2</span>, fill<span class="op">=</span><span class="va">posterior</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"posterior"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#join plots</span></span>
<span><span class="va">prior.plot</span> <span class="op">+</span> <span class="va">likelihood.plot</span> <span class="op">+</span> <span class="va">posterior.plot</span></span></code></pre></div>
<p><img src="A_two_tap_scenario_equalVariance_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="compute-posterior-modes-and-add-to-the-plots">Compute posterior modes and add to the plots<a class="anchor" aria-label="anchor" href="#compute-posterior-modes-and-add-to-the-plots"></a>
</h4>
<p>We can also add the real positions to the plots and compute the
posterior means and add them as well so it becomes better visible how
the posterior is dragged towards the prior. The posterior modes are
computed with the function <em>posterior_params_2Tap_EqVar()</em>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#likelihood</span></span>
<span><span class="va">likelihood.plot</span> <span class="op">&lt;-</span> <span class="va">likelihood.plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x1m</span>, y<span class="op">=</span><span class="va">x2m</span>, size<span class="op">=</span><span class="fl">2</span>, color<span class="op">=</span><span class="st">"white"</span>, shape<span class="op">=</span><span class="fl">21</span>, fill<span class="op">=</span><span class="cn">NA</span><span class="op">)</span> <span class="co">#measured position</span></span>
<span></span>
<span><span class="co">#posterior modes</span></span>
<span><span class="va">Posterior_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/posterior_params_2Tap_EqVar.html">posterior_params_2Tap_EqVar</a></span><span class="op">(</span>x1m <span class="op">=</span> <span class="va">x1m</span>, x2m <span class="op">=</span> <span class="va">x2m</span>, time_t <span class="op">=</span> <span class="va">time_t</span>,</span>
<span>                                     sigma_s <span class="op">=</span> <span class="va">sigma_s</span>, sigma_v <span class="op">=</span> <span class="va">sigma_v</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Posterior_mode_x1</span> <span class="op">&lt;-</span> <span class="va">Posterior_params</span><span class="op">$</span><span class="va">x1_star</span></span>
<span><span class="va">Posterior_mode_x2</span> <span class="op">&lt;-</span> <span class="va">Posterior_params</span><span class="op">$</span><span class="va">x2_star</span></span>
<span></span>
<span><span class="co">#version based on A13</span></span>
<span><span class="va">posterior.plot</span> <span class="op">&lt;-</span> <span class="va">posterior.plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x1m</span>, y<span class="op">=</span><span class="va">x2m</span>, size<span class="op">=</span><span class="fl">2</span>, color<span class="op">=</span><span class="st">"white"</span>, shape<span class="op">=</span><span class="fl">21</span>, fill<span class="op">=</span><span class="cn">NA</span><span class="op">)</span> <span class="op">+</span> <span class="co">#measured position</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Posterior_mode_x1</span> , y<span class="op">=</span><span class="va">Posterior_mode_x2</span>, size<span class="op">=</span><span class="fl">2</span>, color<span class="op">=</span><span class="st">"red"</span>, shape<span class="op">=</span><span class="fl">21</span>, fill<span class="op">=</span><span class="cn">NA</span><span class="op">)</span> <span class="co">#posterior mode</span></span>
<span></span>
<span></span>
<span><span class="co">#join plots</span></span>
<span><span class="va">p.joined</span> <span class="op">&lt;-</span> <span class="va">prior.plot</span> <span class="op">+</span> <span class="va">likelihood.plot</span> <span class="op">+</span> <span class="va">posterior.plot</span></span>
<span><span class="va">p.joined</span></span></code></pre></div>
<div class="figure">
<img src="A_two_tap_scenario_equalVariance_files/figure-html/fig-all-distributions-1.png" alt="prior, likelihood, and posterior distributions" width="700"><p class="caption">
prior, likelihood, and posterior distributions
</p>
</div>
<p>The figure looks just like in the article.</p>
</div>
<div class="section level4">
<h4 id="numerical-sanity-check">Numerical sanity check<a class="anchor" aria-label="anchor" href="#numerical-sanity-check"></a>
</h4>
<p>As a quick sanity check: compare the analytically determined
posterior modes to the ones that can be seen in the figure. This can
simply be done by finding the value with the highest posterior
probability numerically and checking where it is.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Posterior modes determined analytically</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"analytical values for x1:"</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">Posterior_mode_x1</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>            <span class="st">"\n and for x2:"</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">Posterior_mode_x2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "analytical values for x1: 3.941 \n and for x2: 6.059"</span></span>
<span></span>
<span><span class="co">#Posterior mode determined numerically</span></span>
<span><span class="va">posteriorMax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x1x2Mat</span><span class="op">$</span><span class="va">posterior</span><span class="op">)</span></span>
<span><span class="va">posteriorMax.index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">x1x2Mat</span><span class="op">$</span><span class="va">posterior</span><span class="op">==</span><span class="va">posteriorMax</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"numerical values for x1:"</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">x1x2Mat</span><span class="op">$</span><span class="va">x1</span><span class="op">[</span><span class="va">posteriorMax.index</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>            <span class="st">"\n and for x2:"</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">x1x2Mat</span><span class="op">$</span><span class="va">x2</span><span class="op">[</span><span class="va">posteriorMax.index</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "numerical values for x1: 3.939 \n and for x2: 6.061"</span></span></code></pre></div>
<p>We can see that the values match quite well.</p>
</div>
</div>
<div class="section level3">
<h3 id="addressing-the-hypotheses">Addressing the hypotheses<a class="anchor" aria-label="anchor" href="#addressing-the-hypotheses"></a>
</h3>
<p>In this section we will evaluate the hypotheses mentioned above by
varying model parameters.</p>
<div class="section level4">
<h4 id="stimuli-that-are-presented-far-apart-and-fast-will-be-perceptually-attracted-towards-each-other">Stimuli that are presented far apart and fast will be perceptually
attracted towards each other<a class="anchor" aria-label="anchor" href="#stimuli-that-are-presented-far-apart-and-fast-will-be-perceptually-attracted-towards-each-other"></a>
</h4>
<p>This hypothesis is inherently confirmed in the computations above:
note that the veridical stimuli were presented at positions of 3 and 7
cm, respectively. This is a distance of 4 cm. The posterior modes were
at about 3.9 and 6.1 cm. This is only a distance of 2.2 cm. The model
accordingly predicts a length contraction of 4 - 2.2 = 1.8 cm for this
set of parameters.</p>
</div>
<div class="section level4">
<h4 id="the-faster-the-stimulation-the-stronger-is-the-length-contraction">The faster the stimulation, the stronger is the length
contraction<a class="anchor" aria-label="anchor" href="#the-faster-the-stimulation-the-stronger-is-the-length-contraction"></a>
</h4>
<p>To address this point, we repeat the model estimations for different
values of <span class="math inline">\(t\)</span>, the time passing
between the two taps.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x1m<span class="op">=</span><span class="fl">3</span>, x2m<span class="op">=</span><span class="fl">7</span>, time_t<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, length.out<span class="op">=</span><span class="fl">21</span><span class="op">)</span>, sigma_s<span class="op">=</span><span class="fl">1</span>, sigma_v<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#compute posterior modes</span></span>
<span><span class="va">modelData</span><span class="op">$</span><span class="va">pm_x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">modelData</span>, <span class="fu"><a href="../reference/posterior_params_2Tap_EqVar.html">posterior_params_2Tap_EqVar</a></span><span class="op">(</span><span class="va">x1m</span>, <span class="va">x2m</span>, <span class="va">time_t</span>, <span class="va">sigma_s</span>, <span class="va">sigma_v</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">x1_star</span></span>
<span><span class="va">modelData</span><span class="op">$</span><span class="va">pm_x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">modelData</span>, <span class="fu"><a href="../reference/posterior_params_2Tap_EqVar.html">posterior_params_2Tap_EqVar</a></span><span class="op">(</span><span class="va">x1m</span>, <span class="va">x2m</span>, <span class="va">time_t</span>, <span class="va">sigma_s</span>, <span class="va">sigma_v</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">x2_star</span></span>
<span></span>
<span><span class="co">#create a plot</span></span>
<span><span class="va">modelData</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pm_x1</span>, <span class="va">pm_x2</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"posterior"</span>, values_to <span class="op">=</span> <span class="st">"position"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">time_t</span>, y<span class="op">=</span><span class="va">position</span>, color<span class="op">=</span><span class="va">posterior</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">7</span>, linetype<span class="op">=</span><span class="fl">2</span>, color<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">3</span>, linetype<span class="op">=</span><span class="fl">2</span>, color<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
<div class="figure">
<img src="A_two_tap_scenario_equalVariance_files/figure-html/fig-speed-and-contraction-1.png" alt="stronger contraction at shorter time t" width="700"><p class="caption">
stronger contraction at shorter time t
</p>
</div>
<p>As can be seen from the figure, the attraction of the stimuli towards
each other and the according length contraction is strong for short time
intervals between the stimuli and disappears for delays of one second or
more.</p>
</div>
<div class="section level4">
<h4 id="the-further-the-travelled-distance-the-stronger-the-length-contraction">The further the travelled distance, the stronger the length
contraction<a class="anchor" aria-label="anchor" href="#the-further-the-travelled-distance-the-stronger-the-length-contraction"></a>
</h4>
<p>To show predictions for this scenario, we keep t and sigma_s constant
and vary the positions of the taps. Note that due to the small scale, we
have decreased the sigma_s parameter to 0.1 to emphasize the effect.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x1m<span class="op">=</span><span class="fl">0</span>, x2m<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1</span>, length.out<span class="op">=</span><span class="fl">10</span><span class="op">)</span>, time_t<span class="op">=</span><span class="fl">0.015</span>, sigma_s<span class="op">=</span><span class="fl">0.1</span>, sigma_v<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#compute posterior modes</span></span>
<span><span class="va">modelData</span><span class="op">$</span><span class="va">pm_x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">modelData</span>, <span class="fu"><a href="../reference/posterior_params_2Tap_EqVar.html">posterior_params_2Tap_EqVar</a></span><span class="op">(</span><span class="va">x1m</span>, <span class="va">x2m</span>, <span class="va">time_t</span>, <span class="va">sigma_s</span>, <span class="va">sigma_v</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">x1_star</span></span>
<span><span class="va">modelData</span><span class="op">$</span><span class="va">pm_x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">modelData</span>, <span class="fu"><a href="../reference/posterior_params_2Tap_EqVar.html">posterior_params_2Tap_EqVar</a></span><span class="op">(</span><span class="va">x1m</span>, <span class="va">x2m</span>, <span class="va">time_t</span>, <span class="va">sigma_s</span>, <span class="va">sigma_v</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">x2_star</span></span>
<span></span>
<span><span class="co">#create a plot</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">modelData</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pm_x1</span>, <span class="va">pm_x2</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"posterior"</span>, values_to <span class="op">=</span> <span class="st">"position"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x2m</span>, y<span class="op">=</span><span class="va">position</span>, color<span class="op">=</span><span class="va">posterior</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, slope <span class="op">=</span> <span class="fl">1</span>, linetype<span class="op">=</span><span class="fl">2</span>, color<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"posterior modes for \nvarying veridical distances"</span><span class="op">)</span></span>
<span>  </span>
<span></span>
<span><span class="co">#and another plot of the real distance vs. perceived distance  </span></span>
<span><span class="va">modelData</span> <span class="op">&lt;-</span> <span class="va">modelData</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>veridical<span class="op">=</span><span class="va">x2m</span><span class="op">-</span><span class="va">x1m</span>, perceived<span class="op">=</span><span class="va">pm_x2</span><span class="op">-</span><span class="va">pm_x1</span><span class="op">)</span> <span class="co">#compute real and perceived distances</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">modelData</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">veridical</span>, y<span class="op">=</span><span class="va">perceived</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, slope <span class="op">=</span> <span class="fl">1</span>, linetype<span class="op">=</span><span class="fl">2</span>, color<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"veridical vs. perceived \ndistances"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#merge plots</span></span>
<span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span></span></code></pre></div>
<div class="figure">
<img src="A_two_tap_scenario_equalVariance_files/figure-html/fig-varying-distance-and-contraction-1.png" alt="stronger (relative) contraction for larger distances" width="700"><p class="caption">
stronger (relative) contraction for larger distances
</p>
</div>
</div>
<div class="section level4">
<h4 id="the-higher-the-precision-the-weaker-the-length-contraction">The higher the precision, the weaker the length contraction<a class="anchor" aria-label="anchor" href="#the-higher-the-precision-the-weaker-the-length-contraction"></a>
</h4>
<p>This time we keep parameters all parameters constant except for the
sigma_s.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x1m<span class="op">=</span><span class="fl">3</span>, x2m<span class="op">=</span><span class="fl">7</span>, time_t<span class="op">=</span><span class="fl">0.15</span>, sigma_s<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, length.out<span class="op">=</span><span class="fl">21</span><span class="op">)</span>, sigma_v<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#compute posterior modes</span></span>
<span><span class="va">modelData</span><span class="op">$</span><span class="va">pm_x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">modelData</span>, <span class="fu"><a href="../reference/posterior_params_2Tap_EqVar.html">posterior_params_2Tap_EqVar</a></span><span class="op">(</span><span class="va">x1m</span>, <span class="va">x2m</span>, <span class="va">time_t</span>, <span class="va">sigma_s</span>, <span class="va">sigma_v</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">x1_star</span></span>
<span><span class="va">modelData</span><span class="op">$</span><span class="va">pm_x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">modelData</span>, <span class="fu"><a href="../reference/posterior_params_2Tap_EqVar.html">posterior_params_2Tap_EqVar</a></span><span class="op">(</span><span class="va">x1m</span>, <span class="va">x2m</span>, <span class="va">time_t</span>, <span class="va">sigma_s</span>, <span class="va">sigma_v</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">x2_star</span></span>
<span></span>
<span><span class="co">#create a plot</span></span>
<span><span class="va">modelData</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pm_x1</span>, <span class="va">pm_x2</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"posterior"</span>, values_to <span class="op">=</span> <span class="st">"position"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">sigma_s</span>, y<span class="op">=</span><span class="va">position</span>, color<span class="op">=</span><span class="va">posterior</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">7</span>, linetype<span class="op">=</span><span class="fl">2</span>, color<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">3</span>, linetype<span class="op">=</span><span class="fl">2</span>, color<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"posterior modes for \nvarying spatial precisions"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="A_two_tap_scenario_equalVariance_files/figure-html/fig-sigmas-and-contraction-1.png" alt="stronger contraction for lower precision" width="700"><p class="caption">
stronger contraction for lower precision
</p>
</div>
</div>
<div class="section level4">
<h4 id="the-stronger-the-low-speed-prior-the-stronger-the-length-contraction">The stronger the low-speed prior, the stronger the length
contraction<a class="anchor" aria-label="anchor" href="#the-stronger-the-low-speed-prior-the-stronger-the-length-contraction"></a>
</h4>
<p>Finally, the low-speed prior is varied as the only parameter.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x1m<span class="op">=</span><span class="fl">3</span>, x2m<span class="op">=</span><span class="fl">7</span>, time_t<span class="op">=</span><span class="fl">0.15</span>, sigma_s<span class="op">=</span><span class="fl">1</span>, sigma_v<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, length.out<span class="op">=</span><span class="fl">21</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#compute posterior modes</span></span>
<span><span class="va">modelData</span><span class="op">$</span><span class="va">pm_x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">modelData</span>, <span class="fu"><a href="../reference/posterior_params_2Tap_EqVar.html">posterior_params_2Tap_EqVar</a></span><span class="op">(</span><span class="va">x1m</span>, <span class="va">x2m</span>, <span class="va">time_t</span>, <span class="va">sigma_s</span>, <span class="va">sigma_v</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">x1_star</span></span>
<span><span class="va">modelData</span><span class="op">$</span><span class="va">pm_x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">modelData</span>, <span class="fu"><a href="../reference/posterior_params_2Tap_EqVar.html">posterior_params_2Tap_EqVar</a></span><span class="op">(</span><span class="va">x1m</span>, <span class="va">x2m</span>, <span class="va">time_t</span>, <span class="va">sigma_s</span>, <span class="va">sigma_v</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">x2_star</span></span>
<span></span>
<span><span class="co">#create a plot</span></span>
<span><span class="va">modelData</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pm_x1</span>, <span class="va">pm_x2</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"posterior"</span>, values_to <span class="op">=</span> <span class="st">"position"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">sigma_v</span>, y<span class="op">=</span><span class="va">position</span>, color<span class="op">=</span><span class="va">posterior</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">7</span>, linetype<span class="op">=</span><span class="fl">2</span>, color<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">3</span>, linetype<span class="op">=</span><span class="fl">2</span>, color<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"posterior modes for \nvarying speed priors"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="A_two_tap_scenario_equalVariance_files/figure-html/fig-sigmav-and-contraction-1.png" alt="stronger contraction for lower expected speed" width="700"><p class="caption">
stronger contraction for lower expected speed
</p>
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Xaver Fuchs.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
